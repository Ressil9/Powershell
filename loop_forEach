$filePath = "C:\Users\MachNP\OneDrive - Luxottica Group S.p.A\Bureau\Powershell\copy-list.txt"
$folderPath = "C:\Users\MachNP\OneDrive - Luxottica Group S.p.A\Bureau\Powershell\FolderNames"


$folderNames = Get-Content -Path $filePath


foreach ($name in $folderNames) {

    if ((Test-Path -Path "$folderPath\$name") -eq $false) {
        New-Item -Path $folderPath -Name $name -ItemType Directory 
    } else {
        Write-Output "Folder exists"
    }
}

$folderNames | foreach-Object -Process {

    if ((Test-Path -Path "$folderPath\$_") -eq $false) {
        New-Item -Path $folderPath -Name $_ -ItemType Directory 
    } else {
        Write-Output "Folder exists"
    }
}

$folderNames.ForEach( 
    {

        if ((Test-Path -Path "$folderPath\$_") -eq $false) {
            New-Item -Path $folderPath -Name $_ -ItemType Directory 
        } else {
            Write-Output "Folder exists"
        }
    }
)
